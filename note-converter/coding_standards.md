# コーディング規約

このドキュメントは、プロジェクトにおけるコーディング規約とベストプラクティスを定義します。これらのルールは、コードの一貫性、可読性、保守性を向上させるために設計されています。

## 1. 命名規則

### 1.1 ファイル名
- Pythonファイル: スネークケース（例: `file_name.py`）
- マークダウンファイル: スネークケース（例: `document_name.md`）
- テストファイル: `test_` で始める（例: `test_module.py`）

### 1.2 変数名
- 変数名: スネークケース（例: `variable_name`）
- 定数: 大文字のスネークケース（例: `CONSTANT_VALUE`）
- プライベート変数: アンダースコアで始める（例: `_private_var`）

### 1.3 クラス名
- クラス名: パスカルケース（例: `ClassName`）
- メソッド名: スネークケース（例: `method_name`）

### 1.4 関数名
- 関数名: スネークケース（例: `function_name`）
- 関数名は動詞で始める（例: `get_data()`, `process_file()`）

## 2. コードスタイル

### 2.1 インデント
- 4スペースを使用する
- タブは使用しない

### 2.2 行の長さ
- 1行は最大88文字
- 長い行は適切に折り返す

### 2.3 インポート
- 標準ライブラリ、サードパーティライブラリ、ローカルモジュールの順に記述し、それぞれをブロックで分ける
- アルファベット順にソートする
- ワイルドカードインポート（`from module import *`）は避ける

```python
# 例
import os
import sys

import requests
from dotenv import load_dotenv

from app.utils import helper
```

### 2.4 ドキュメンテーション
- すべての関数、クラス、モジュールにはdocstringを付ける
- Google形式のdocstringを使用する

```python
def function_name(param1, param2):
    """関数の簡潔な説明。

    より詳細な説明（必要な場合）。

    Args:
        param1 (int): 最初のパラメータの説明
        param2 (str): 2番目のパラメータの説明

    Returns:
        bool: 戻り値の説明

    Raises:
        ValueError: エラーの説明
    """
    pass
```

## 3. エラーハンドリング

### 3.1 例外処理
- 具体的な例外型をキャッチする（`except Exception:`ではなく`except ValueError:`など）
- 例外を握りつぶさない（空の`except`ブロックは避ける）
- コンテキストマネージャ（`with`文）を適切に使用する

### 3.2 ログ記録
- `print`ではなく、`logging`モジュールを使用する
- 適切なログレベルを使用する（DEBUG, INFO, WARNING, ERROR, CRITICAL）
- 例外発生時は、スタックトレースも記録する

## 4. テスト

### 4.1 テスト戦略
- すべての公開関数とメソッドに単体テストを書く
- モックやスタブを適切に使用する
- 境界値のテストケースを含める

### 4.2 テストツール
- `pytest`を使用する
- テストカバレッジレポートを生成する
- CI/CDパイプラインでテストを自動化する

## 5. バージョン管理

### 5.1 コミットメッセージ
- 簡潔で具体的なコミットメッセージを書く
- 現在形を使用する（"Fixed bug"ではなく"Fix bug"）
- 必要に応じて詳細な説明を追加する

### 5.2 ブランチ戦略
- 機能開発は`feature/`で始まるブランチで行う
- バグ修正は`bugfix/`で始まるブランチで行う
- リリース準備は`release/`で始まるブランチで行う

## 6. セキュリティ

### 6.1 機密情報
- ハードコードされたシークレットや認証情報はコードに含めない
- 環境変数や設定ファイルを使用する
- `.env`ファイルはバージョン管理から除外する

### 6.2 入力検証
- すべてのユーザー入力を検証する
- SQLインジェクションや他の一般的な攻撃ベクトルを防止する

## 7. パフォーマンス

### 7.1 リソース管理
- ファイルやネットワーク接続などのリソースは使用後に必ず閉じる
- メモリ使用量を監視し、大きなオブジェクトは適切に解放する

### 7.2 アルゴリズム効率
- 処理時間とメモリ使用量のバランスを考慮する
- 計算量の高い処理は最適化する

## 8. ドキュメンテーション

### 8.1 プロジェクトドキュメント
- READMEファイルにプロジェクトの概要、セットアップ手順、使用例を記載する
- API仕様書を維持する
- 変更履歴を記録する

### 8.2 コードドキュメント
- コードの複雑な部分には適切なコメントを追加する
- 「なぜ」そのコードが必要なのかを説明する（「何を」しているかは良いコードから明らかであるべき）

## 9. コード品質

### 9.1 静的解析
- `flake8`、`pylint`、`mypy`などの静的解析ツールを使用する
- `.flake8`、`.pylintrc`などの設定ファイルをプロジェクトルートに配置する

### 9.2 コードレビュー
- すべてのコード変更はレビューを受ける
- コードレビューではこの規約に準拠しているかを確認する 