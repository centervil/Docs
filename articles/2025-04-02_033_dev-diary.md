---
title: 開発日記処理とZennテンプレートを改善しました（開発日記 No.033）
emoji: 🛠️
type: idea
topics: ["開発日記", "Zenn", "自動化"]
published: false
---

>この記事はgemini-2.0-flash-thinking-exp-01-21によって自動生成されています。

## 関連リンク

[前回の開発日記](./2025-04-01-32-DiaryConverter-development.md)

## はじめに

昨日はDiaryConverterの開発を進め、Zenn公開用の記事を自動生成する機能の改善に取り組みました。今日は、そのDiaryConverterが生成する開発日記のファイル名処理と、Zenn記事のテンプレートをさらに改善していくことにします。より効率的な開発ワークフローを目指して、今日も一日頑張ります！

## 背景と目的

これまで開発日記のファイル名やZenn記事のテンプレートは、試行錯誤しながら少しずつ形作ってきました。しかし、運用していく中でいくつかの課題が見えてきました。

ファイル名に関しては、日付や通し番号だけでなく、テーマ名やプロジェクト名を含める命名規則にしていましたが、これが少し冗長に感じてきました。また、Zennテンプレートについても、タイトルにテーマ名を含める形式にしていましたが、日記の内容から自動生成する方が自然ではないかと考え始めました。

そこで、今回はこれらの課題を解決し、よりシンプルで使いやすい開発日記処理とZennテンプレートに改善することを目的としました。

## 検討内容

今回の改善の中心は、以下の点です。

*   **開発日記ファイル名の命名規則の見直し**:
    *   日付と通し番号を基本とし、テーマ名は含めないシンプルな形式に変更する。
    *   SLUGは固定値とする。
*   **`diary_converter.py` の修正**:
    *   新しい命名規則に合わせて、テーマ名やプロジェクト名の参照を削除する。
    *   Issue番号の使用を廃止する。
    *   通し番号をZennテンプレートの `[連番]` に正しく挿入するように修正する。
*   **`zenn_template.md` の修正**:
    *   `title` の `[テーマ名]` を削除し、日記の内容から自動生成するように変更する。
    *   関連リンクは前回の開発日記のみに限定する。
    *   Frontmatterの `type` を `idea` で固定する。
    *   開発サイクルの紹介文を削除する。
    *   LLM変換指示と記述ガイドラインを整理し、一箇所にまとめる。

これらの変更により、開発日記のファイル名がよりシンプルになり、Zenn記事のテンプレートもより洗練されたものになるはずです。

## 実装内容

まず、`diary-filename-processor.sh` を修正しました。開発日記の命名規則に合わせて、日付と通し番号のみを抽出し、SLUGを固定値とするように変更しました。これにより、ファイル名が以前よりもすっきりしました。

次に、`diary_converter.py` を修正しました。テーマ名やプロジェクト名を参照していた箇所を削除し、Issue番号の使用も停止しました。そして、通し番号がZennテンプレートの `[連番]` に正しく反映されるように修正しました。

```diff
--- a/Diary-Converter/src/diary_converter/diary_converter.py
+++ b/Diary-Converter/src/diary_converter/diary_converter.py
@@ -27,13 +27,10 @@
         template_path = Path(template_dir) / template_name
         output_path = Path(output_dir) / output_filename

-        # テンプレートファイルの内容を読み込む
         with open(template_path, "r", encoding="utf-8") as f:
             template_content = f.read()

-        # テンプレートをレンダリング
         rendered_content = template_content.replace("[タイトル]", title)
-        rendered_content = rendered_content.replace("[テーマ名]", theme_name) # テーマ名削除
         rendered_content = rendered_content.replace("[連番]", serial_number)
         rendered_content = rendered_content.replace("[日付]", date)
         rendered_content = rendered_content.replace("[前回の開発日記のリンク]", previous_diary_link)
```

さらに、`zenn_template.md` を修正しました。`title` から `[テーマ名]` を削除し、関連リンクを前回の開発日記のみに限定しました。Frontmatterの `type` を `idea` に固定し、不要になった開発サイクルの紹介文を削除しました。また、LLM変換指示と記述ガイドラインを整理し、より分かりやすいように記述場所をまとめました。

```diff
--- a/Diary-Converter/templates/zenn_template.md
+++ b/Diary-Converter/templates/zenn_template.md
@@ -1,7 +1,7 @@
 ---
-title: "[テーマ名]（開発日記 [連番]）"
+title: "開発日記[連番]"
 emoji: ✨
-type: tech
+type: idea
 topics: ["開発日記"]
 published: false
 ---
@@ -12,14 +12,10 @@

 ## 関連リンク

- [前回の開発日記](./[前回の開発日記のファイル名])
+ [前回の開発日記](./[前回の開発日記のファイル名])

 ## はじめに

- この開発日記では、日々の開発作業を記録し、
- 振り返りや改善に役立てることを目的としています。
-
- 開発サイクルとしては、
- 1.  **テーマ設定**: 今日の開発テーマを決定します。
- 2.  **開発**: テーマに沿って開発作業を行います。
- 3.  **記録**: 作業内容を開発日記に記録します。
- 4.  **振り返り**: 日記を振り返り、改善点や今後の課題を検討します。
+ 昨日の簡単な振り返りと、今日取り組むテーマの導入。

 ## 背景と目的

@@ -40,6 +36,9 @@

 ## まとめ

- 今日の開発内容の簡単なまとめ
+ 開発内容の簡潔なまとめ、成果や学びの強調。

 ```

最後に、`Diary-Converter/action.yml` も `diary_converter.py` の変更に合わせて修正が必要か確認しましたが、今回は特に修正は不要でした。また、テストファイルについても確認しましたが、今回の変更による修正は不要と判断しました。

しかし、生成された記事 `2025-04-02_033_dev-diary.md` を確認したところ、タイトルの `#` が消えていたり、関連リンクの見出しが `::: RelineLink` になってしまう問題が発生しました。これは `zenn_template.md` の修正が不十分だったことが原因と考えられます。

そこで、再度 `zenn_template.md` を修正し、タイトル内の連番表記を `No.[連番]` に変更し、関連リンクの見出しが `## 関連リンク` となるようにLLMへの指示を明確化しました。これにより、生成される記事の品質が向上するはずです。

## 技術的なポイント

今回の実装における技術的なポイントは、以下の点です。

*   **ファイル名処理のシンプル化**: `diary-filename-processor.sh` を修正し、日付と通し番号のみに基づいたシンプルな命名規則に変更したことで、ファイル管理が容易になりました。
*   **テンプレートエンジンの利用**: `diary_converter.py` でテンプレートエンジン（今回は単純な文字列置換）を利用することで、Zenn記事のフォーマットを柔軟に生成できるようになりました。
*   **継続的なテスト**: テストコードを整備し、変更を加えるたびにテストを実行することで、品質を維持しています。

## 所感

今日の開発では、開発日記処理とZennテンプレートの改善を通じて、よりスムーズなZenn公開ワークフローに一歩近づけたと感じています。特に、ファイル名の命名規則をシンプルにしたことで、日記ファイルの管理が格段に楽になりました。

また、Zennテンプレートの修正を通じて、生成される記事の品質を向上させることができました。最初は少し問題が発生しましたが、試行錯誤の末に解決できたことは大きな収穫です。

開発ツールは、使っていく中で初めて課題が見えてくるものだと改めて感じました。今回の改善も、日々の開発日記作成を通じて感じた不便さから生まれたものです。これからも、自分自身の開発スタイルに合わせて、ツールを継続的に改善していくことが重要だと考えています。

## 今後の課題

今回の改善で、開発日記処理とZennテンプレートはかなり洗練されたものになったと思いますが、まだ改善の余地はあります。

*   **タイトル自動生成の精度向上**: 今回は `title` から `[テーマ名]` を削除しましたが、日記の内容からより適切なタイトルを自動生成できるように、今後も検討していきたいです。
*   **テンプレートの柔軟性向上**:  `zenn_template.md` をさらに柔軟にカスタマイズできるように、テンプレートエンジンの機能を拡充することも検討課題です。
*   **テストの拡充**:  より多くのパターンを網羅できるように、テストケースを拡充していくことも重要です。

## まとめ

今日は、開発日記処理とZennテンプレートの改善に取り組みました。ファイル名の命名規則をシンプルにし、Zennテンプレートを修正することで、より効率的で高品質なZenn公開ワークフローを構築することができました。今回の改善を通じて、開発ツールは継続的に改善していくことで、より強力な味方になることを改めて実感しました。今後も、ツールの改善を続けながら、より快適な開発環境を追求していきたいと思います。