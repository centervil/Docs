---
title: "CIパイプラインのテンプレート適用不具合調査・修正（開発日記 No.103）"
emoji: "🛠️"
type: "idea"
topics: ["開発日記", "CIパイプライン", "テンプレート"]
published: false
---

:::message
この記事はgemini-2.5-flash-preview-04-17によって自動生成されています。
:::

## 関連リンク

- [前回の開発日記](https://zenn.dev/centervil/articles/2025-06-10_102_dev-diary)

## はじめに

昨日はContent-Converterへの移行、ワークフローのスクリプト化、テンプレート・プロンプトの改善、記事後処理の自動化を行いました。本日は、CIパイプラインにおけるテンプレート適用不具合の調査と修正に取り組みます。

## 背景と目的

CIパイプラインにおいて、テンプレートが正しく適用されない、または余計な文字列が混入するという問題が発生していました。この問題を解決し、CIパイプラインの安定性を向上させることを目的とします。

## 検討内容

問題の再現と原因特定のため、テンプレート置換からContent-Converter出力までの一連の流れをテスト用ダミーファイルで自動検証することにしました。不具合が再現した場合、スクリプト、プロンプト、テンプレートのいずれに問題があるか調査し、修正を行います。

## 実装内容

まず、テストディレクトリを作成し、テンプレート置換スクリプトのテストとContent-Converter出力例の後処理、テンプレート置換の一連の自動テストを実施しました。具体的には、以下の手順を自動化しました。

1.  ダミーファイルの作成
2.  後処理の実行
3.  テンプレート置換の実行
4.  最終出力の確認

その結果、全工程が期待通り動作することを確認できました。

```bash
# テストスクリプト実行例 (簡略化)
./test_pipeline.sh
```

## 技術的なポイント

今回の実装における技術的なポイントは、テスト基盤の整備です。自動テストを容易に実行できるようにすることで、今後の再発防止や自動検証に役立てることができます。また、テンプレート・プロンプトの重複を圧縮し、英語翻訳を行うことで、LLMのコンテキスト効率と出力安定性を向上させました。

## 所感

今回の開発では、CIパイプラインの不具合を特定し、修正することができました。自動テストの重要性を改めて認識しました。また、テンプレートやプロンプトの改善を通じて、LLMのパフォーマンスを向上させることの重要性も学びました。しかし、完全に自動化するにはまだ課題が多く、今後の改善が必要です。

## 今後の課題

今後は、より複雑なケースに対応できるテストケースの拡充や、エラーハンドリングの強化など、テスト基盤のさらなる改善が必要です。また、テンプレートとプロンプトの管理方法についても、より効率的な方法を検討する必要があります。

## まとめ

本日の開発では、CIパイプラインにおけるテンプレート適用不具合を解消し、テスト基盤を整備しました。これにより、CIパイプラインの安定性と効率が向上しました。今後は、テスト基盤のさらなる改善と、テンプレート・プロンプトの管理方法の改善に取り組んでいきたいと思います。