# 統合自動記録プロンプト (軽量版)

このガイドは開発セッション記録の軽量化・自動化のための指示プロンプトです。コンテキスト量を削減しながら効率的に開発記録を取得します。

## 基本コマンド

会話の最初に以下のコマンドだけを実行すれば、すべての設定が完了します：

```
@dev-log-start テーマ="開発テーマ" records_path="/path/to/dev-records"
```

### パラメータ
- `テーマ`: 今日の開発テーマ（必須）
- `records_path`: 開発記録ディレクトリの絶対パス（必須、初回のみ）

## ワークスペース構成

- **開発対象プロジェクトのみのワークスペース**
  - 開発記録（dev-records）はワークスペースに含めない
  - 作業対象のコードベースのみを含める
- **外部ディレクトリへのアクセス**
  - fileSystem MCPを使用して外部ディレクトリにアクセス
  - パスの絶対指定により確実なファイル操作を実現

## 自動記録処理

初期化処理が実行されると、以下が自動的に行われます：

1. **日付と連番の取得**
   - 今日の日付（YYYY-MM-DD形式）
   - 連番（最新ファイル番号+1）
   - ファイル名: `YYYY-MM-DD_NNN_development.md`
   - **重要**: ファイル名には必ず「development」を使用し、テーマ名は含めないこと。テーマ名はファイル内容に記載する。

2. **基本テンプレートの適用**
   ```markdown
   # YYYY-MM-DD development
   
   ## 今日の開発テーマ
   
   今日の開発テーマは[テーマ]です。
   
   ## 前日までの活動履歴
   前日までの活動履歴は以下の通りです：
   * YYYY-MM-DD: [活動内容] (ファイル名: YYYY-MM-DD_NNN_development.md)
   
   ## 会話ログ
   
   - ユーザー: [最初のメッセージ]
   - LLM: [応答]
   ...
   ```

3. **会話記録の自動化**
   - 各対話を「- ユーザー: 」または「- LLM: 」で開始
   - 対話内容を自動記録
   - コード出力やツール実行結果は要約形式で記録
   - 各対話後に自動的に記録を更新

## 会話ログ記録ルール

会話ログの詳細なフォーマットと記録ルールについては、「[conversation_log_format_optimized.md](./conversation_log_format_optimized.md)」を参照します。このファイルには以下の基本ルールが含まれています：

1. **ユーザーの指示**: 漏れなく完全に記録
2. **LLMの応答**: 思考プロセス・提案内容を含め記録（コード出力は要約）
3. **会話の流れ**: 対話の順序を維持し、議論と決定事項を記録
4. **記録の最適化**:
   - 重要な対話は完全記録
   - 大量出力は要約記録
   - 自動保存ポイントで信頼性確保

## 注意事項

1. 初回使用時のみ `records_path` の設定が必要
2. fileSystem MCPの利用には適切な権限が必要
3. 長時間セッションでは定期的に保存状態を確認

## 開発終了時の処理

開発セッション終了時（ユーザーから終了する旨の指示があった場合）には、以下の処理を行います：

1. **開発記録の確認**
   - 開発記録ファイルを確認し、対話内容が正しく記録されているか確認
   - 未記入の対話があれば、追加記録

2. **終了時刻の記録**
   - 開発終了時刻を記録

3. **バックアップ処理**
   - 自動記録がうまくいかなかった場合のバックアップとして、全対話履歴を確認
   - 未記録の対話を追加

この処理により、自動記録が正常に機能しなかった場合でも、開発記録の完全性を確保します。
